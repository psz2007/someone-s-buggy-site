---

layout: default
title: 二次型
sort_order: 1
is_node: true

---

## 实对称矩阵的对角化

先来考虑实数域上对称矩阵的性质。

- 对称矩阵的特征值都是实数。

复数没咋学过，所以不会证明，这个东西要用到共轭。

$$
A\alpha=\lambda \alpha
$$

那么如果 $\overline \lambda =\lambda$ 则说明特征值都是实数。

$$
A\overline \alpha=\overline \lambda \overline \alpha\\
\alpha^TA=\lambda \alpha^T\\
\alpha^T A\overline \alpha=\alpha^T\overline \lambda \overline \alpha=\lambda \alpha^T\overline \alpha
$$

那么就可以得到 $\lambda=\overline \lambda$ ，所以特征根都是实数。 

- 对称矩阵的特征子空间彼此正交。

假设有 $\lambda_1\ne \lambda_2$，以及他们的特征向量 $\alpha_1,\alpha_2$。

$$
\lambda_1(\alpha_1,\alpha_2)=(A\alpha_1,\alpha_2)=\alpha_2^TA\alpha_1\\
=\alpha_2^TA^T\alpha_1=(\alpha_1,A\alpha_2)=\lambda_2(\alpha_1,\alpha_2)\\
(\alpha_1,\alpha_2)=0
$$

- 对称矩阵一定可对角化。

采用归纳法，如果 $n-1$ 的对称矩阵已经证明，现在考虑清掉一行一列。

取特征值 $\lambda_1$，以及对应的单位特征向量 $\eta_1$。

构造 $R^n$ 的正交基 $P=(\eta_1,\eta_2,...,\eta_n)$。

$$
P^{-1}AP=P^{-1}(\lambda_1 \eta_1,A\eta_2,...,A\eta_n)
$$

而 $P^{-1}=P^T,\eta_1^T\eta_1=1$，所以有得到了一个左上角是 $\lambda$，别的第一行和第一列全是 $0$。

直接带入矩阵乘法的式子可以证明 $P^{-1}AP$ 也是对称的，所以归纳成立。

这里可以看到，对称矩阵的对角化乘的矩阵是正交矩阵，所以叫做正交相似。

- 如果矩阵正交相似于对角矩阵，那么一定是对称矩阵。

- 对于任意对称矩阵 $A$，$PAP^T$ 依然是对称矩阵，其中 $P$ 是正交矩阵。

证明就是：

$$
(PAP^T)^T=PA^TP^T=PAP^T
$$

## 二次型

对于向量 $X=(x_1,x_2,...,x_n)^T$，定义其二次函数：

$$
f(X)=\sum a_{i,j}x_ix_j
$$

其中满足 $a_{i,j}=a_{j,i}$ 称为二次型。

容易发现 $f(A)=X^TAX$，$A$ 就是这个二次型的矩阵。

我们对于 $X$ 进行线性变换，有可逆矩阵 $C$，使得 $X=CY$，那么 $Y$ 是 $X$ 的一个线性替换。

$$
f(X)=X^TAX=Y^T(C^TAC)Y
$$

那么得到了一个新的二次型 $g(Y)=Y^TBY$。

由于对称矩阵可以对角化，我们可以找到正交相似对角矩阵，有 $A=P^TDP$，那么令 $X=PY$，此时得到的 $g(Y)$ 的矩阵就是对角矩阵。

根据上面的定义，如果有可逆矩阵 $P$，满足 $P^TAP=B$，那么 $A,B$ 合同，容易证明这是个等价关系，并且有对称矩阵合同于对角矩阵。

## 把二次型对角化

有几种常见做法。

### 配方法

*   **步骤**：
    1.  **若二次型中含有平方项**（如 $x_1^2$）：
        *   选取某个平方项（例如 $x_1^2$），将所有含有 $x_1$ 的项集中起来进行配方。
        *   令配方后的括号内部分为一个新变量（如 $y_1$）。
        *   对剩余部分重复此步骤，直到没有交叉项。
    2.  **若二次型中不含任何平方项**（只有 $x_1x_2$ 这种交叉项）：
        *   先做辅助变换：令 $x_1 = u + v, x_2 = u - v$，代入后即可造出平方项（$u^2 - v^2$）。
        *   然后再按第1种情况进行配方

### 正交变换法

*   **步骤**：
    1.  **求特征值**：计算特征方程 $|\lambda E - A| = 0$，求出所有特征值 $\lambda_1, \dots, \lambda_n$。
    2.  **求特征向量**：对每个特征值，解方程 $(\lambda E - A)x = 0$ 得到基础解系。
    3.  **正交化与单位化**：
        *   若有重根（重特征值），需将对应的特征向量用**施密特（Schmidt）正交化**方法正交化。
        *   将所有特征向量**单位化**（长度变为1）。
    4.  **构造矩阵**：将处理好的特征向量作为列向量，组成正交矩阵 $P$。
    5.  **结果**：标准型直接为 $f = \lambda_1 y_1^2 + \dots + \lambda_n y_n^2$（系数即为特征值）。

这样求出的矩阵满足对角化后是特征值，并且变换矩阵一定是正交矩阵，既是相似又是合同。

### 初等变换法

*   **步骤**：
    1.  写出矩阵 $A$。若需要求变换矩阵，可构造分块矩阵 $\begin{pmatrix} A \\ E \end{pmatrix}$ 或 $(A \mid E)$。
    2.  对 $A$ 施加初等行变换（只能用将某行倍加到另一行，或交换两行），将其化为上三角矩阵（或对角形）。
    3.  **注意**：每做一次行变换，必须紧接着对矩阵做一次**同类型的列变换**。
    4.  最终 $A$ 变为对角阵 $\Lambda$，对角线上的元素即为标准型的系数。

原理是因为可逆矩阵 $P$ 可以写成初等变换矩阵的乘积。

## 规范型

矩阵的合同是等价关系，上面的对角化得到的对角矩阵并不唯一，因此要找到一个更唯一的形式来代表一个等价类。

- 合同矩阵秩相同。

因为 $P,P^T$ 都是可逆矩阵，乘上不改变秩，也就是说对角化后的矩阵非 $0$ 个数固定。

- 合同对角化后的矩阵对角线上元素可交换，也可以对于一个元素乘以 $k^2$。

交换和数乘是初等变换。

因此我们可以把矩阵对角化成 $\text{diag}\{1,1..,1,-1,-1,...,-1,0,0...,0\}$ 的形式，这个形式称为规范型。

- 一个矩阵只合同一个规范型。

由于合同是等价关系，我们只需要证明两个规范型不合同即可。

这里从矩阵考虑比较难，因为合同矩阵没啥性质。

转化成二次型考虑，有规范型 $A,B$，证明不存在 $X^TAX=Y^TBY,X=CY$。

注意到二次型是函数 $f(X)$，如果我们带入一组 $x$ 证明了两边不一样说明二次型就必然不同。

设 

$$
f(X)=\sum_{i=1}^p x_i^2-\sum_{i=p+1}^r x_i^2 \\
g(Y)=\sum_{i=1}^q y_i^2-\sum_{i=q+1}^r y_i^2\\
x_i=\sum c_{i,j}y_j\\
f(X)=g(Y)
$$ 

由于都是平方项，一个简单的想法是让一边 $\le 0$ ，一边 $>0$ 就可以找到一组反例。

假设 $p<q$，反过来同理。

令 $y_{q+1}=y_{q+2}=...=y_r=0,x_1=x_2=...=x_p=0$ 。

那么这个 $x$ 上的限制相当于就是对于 $y_1,y_2,...,y_q$ 的线性方程组，而 $q>p$，因此一定有非零解。

所以此时 $g(Y)>0,f(X)\le 0$ ，我们就证明了两个规范型一定不合同。

该定理叫做惯性定理，我们成功证明了实对称矩阵对角化后正数和负数的个数是确定的，正数个数叫做正惯性指数，负数个数叫做负惯性指数，正数个数减去负数个数叫做符号差。

---

而如果在复数域上考虑对称矩阵，由于我现在乘以 $k^2$ 可以乘以负数了，所以只需要保证秩不变，因此最后会变成矩阵 $I_r$，也就是两个复数域矩阵合同只需要秩相同。

因此判断两个矩阵是否合同，先判秩，再算正惯性系数即可。

